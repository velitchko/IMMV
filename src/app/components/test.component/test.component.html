<mat-sidenav-container class="container">
    <mat-sidenav #sidenav mode="side" [opened]="personSelected">
        <!-- Details about selected person -->
        <div class="detail" *ngIf="selectedPerson">
            <button id="close-btn" mat-icon-button (click)="closePersonDetails()">
                <mat-icon>close</mat-icon>
            </button>
            <div class="person-details">
                <h3>{{ selectedPerson.name }}</h3>
                <mat-chip-list>
                    <mat-chip *ngFor="let r of selectedPerson.roles">{{ r }}</mat-chip>
                </mat-chip-list>
                <div *ngFor="let d of selectedPerson.dates">
                    <p>{{ displayDate(d.date) }} {{ d.dateName }}</p>
                </div>

                <div *ngFor="let d of selectedPerson.functions">
                    <p>{{ displayDate(d.startDate) }} - {{ displayDate((d.endDate)) }} {{ d.dateName }}</p>
                </div>
            </div>
        </div>
    </mat-sidenav>

    <mat-sidenav-content>
        <div id="options">
            <div>
                <button mat-flat-button (click)="getList()"><mat-icon>list</mat-icon> show list</button>
                <button mat-flat-button (click)="clearList()"><mat-icon>clear_all</mat-icon> hide list</button>
            </div>
            <div>
                <!-- <button mat-flat-button (click)="updateScales()"><mat-icon>zoom_in</mat-icon> apply zoom</button> -->
            </div>
            <div>
                <mat-slide-toggle (change)="showExiled()">Exiled</mat-slide-toggle>
            </div>
            <mat-radio-group class="filter-radio-group">
                <mat-radio-button *ngFor="let e of eventTypes" (change)="filterEventsByType(e)" [value]="e">{{ e }}</mat-radio-button>
            </mat-radio-group>
            <mat-form-field>
                <mat-label>Order by</mat-label>
                <mat-select [(value)]="currentOrder" placeholder="Order by" (selectionChange)="updateOrder()">
                    <mat-option *ngFor="let o of ordering" [value]="o">{{ o }}</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field>
                    <mat-label>Group by</mat-label>
                    <mat-select [(value)]="currentGrouping" placeholder="Group by" (selectionChange)="updateGroup()">
                        <mat-option *ngFor="let o of grouping" [value]="o">{{ o }}</mat-option>
                    </mat-select>
                </mat-form-field>
            <div id="autocomplete">
                <mat-form-field>
                    <input matInput placeholder="Person" [matAutocomplete]="auto" [formControl]="peopleCtrl">
                    <button mat-button matSuffix mat-icon-button aria-label="Clear" (click)="clearAutoComplete()">
                        <mat-icon>close</mat-icon>
                    </button>
                    <mat-autocomplete #auto="matAutocomplete">
                        <mat-option *ngFor="let person of filteredPeople | async" [value]="person.name" (click)="displayPersonDetails(person.name)">
                            <span>{{ person.name }}</span> 
                        </mat-option>
                    </mat-autocomplete>
                </mat-form-field>
            </div>
        </div>
        <div id="wrapper">
            <div id="timeline-radial" #timelineRadial></div>
            <div id="timeline-chart" #timelineChart></div>
            <div id="people">
                <mat-accordion>
                    <mat-expansion-panel *ngFor="let p of currentlySelectedPeople">
                        <mat-expansion-panel-header class="people-headers-align">
                            <mat-panel-title><b>{{ p.name }}</b></mat-panel-title>
                            <mat-panel-description>{{ p.events.length }} events</mat-panel-description>
                        </mat-expansion-panel-header>
                        <button mat-flat-button (click)="displayPersonDetails(p.name)"><mat-icon>info</mat-icon> Details</button>
                        <div *ngFor="let e of p.events">    
                            <div class="event-dot" [ngStyle]="{'background-color': getColorForType(e.color)}" [matTooltip]="e.color"></div>
                            <h4 class="event-header">{{ e.dateName }}</h4>
                            <p>({{ displayDate(e.startDate) }} - {{ displayDate(e.endDate) }})</p>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
            </div>
        </div>
        <div id="date-extent">
            <h3>{{ displayDate(currentlySelectedMinDate) }}</h3>
            <h3>&nbsp; - &nbsp;</h3>
            <h3>{{ displayDate(currentlySelectedMaxDate) }}
                ({{ getDuration(currentlySelectedMinDate, currentlySelectedMaxDate)}} years)</h3>
        </div>
    </mat-sidenav-content>
</mat-sidenav-container>

<div id="tooltip" #tooltip></div>