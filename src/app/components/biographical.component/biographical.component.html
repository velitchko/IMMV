<mat-sidenav-container class="container">
    <mat-sidenav #sidenav mode="side" [opened]="objectSelected">
        <!-- Details about selected person -->
        <div class="detail" *ngIf="selectedObject">
            <button id="close-btn" mat-icon-button (click)="closePersonDetails()">
                <mat-icon>close</mat-icon>
            </button>
            <div class="person-details">
                <h3>{{ selectedObject.name }}</h3>
            </div>
            <div *ngIf="selectedObject.objectType === 'Event'">
                <mat-chip-list>
                    <mat-chip *ngFor="let r of selectedObject.themes">{{ getThemeName(r.theme) }}</mat-chip>
                </mat-chip-list>
                <p>{{ displayDate(selectedObject.startDate) }} {{ selectedObject.endDate ? '-' : '' }} {{ displayDate(selectedObject.endDate) }}</p>

                <div *ngFor="let person of selectedObject.peopleOrganizations">
                    <a href="javascript:void(0)">{{ getPersonOrganizationName(person.personOrganization) }}</a>
                </div>

                <div *ngFor="let location of selectedObject.locations">
                    <a href="javascript:void(0)">{{ getLocationName(location.location) }}</a>
                </div>

                <div *ngFor="let source of selectedObject.sources">
                    <a href="javascript:void(0)">{{ getSourceName(source.source) }}</a>
                </div>

                <div *ngFor="let event of selectedObject.events">
                    <a href="javascript:void(0)">{{ getEventName(event.event) }}</a>
                </div>
            </div>
            <div *ngIf="selectedObject.objectType === 'Person'">
                <mat-chip-list>
                    <mat-chip *ngFor="let r of selectedObject.roles">{{ r }}</mat-chip>
                </mat-chip-list>
                <div *ngFor="let d of selectedObject.dates">
                    <p>{{ displayDate(d.date) }} {{ d.dateName }}</p>
                </div>

                <div *ngFor="let d of selectedObject.functions">
                    <p>{{ displayDate(d.startDate) }} - {{ displayDate((d.endDate)) }} {{ d.dateName }}</p>
                </div>
                <p>{{ selectedObject.bio }}</p>
                <div *ngFor="let person of selectedObject.peopleOrganizations">
                    <a href="javascript:void(0)">{{ getPersonOrganizationName(person.personOrganization) }}</a>
                </div>
                <div *ngIf="selectedObject.identifiers.length > 0">
                    <span>More information...</span>
                    <div *ngFor="let identifier of selectedObject.identifiers">
                        <a [href]="identifier.url" target="_blank">{{ identifier.identifierType }}</a>
                    </div>
                </div>
            </div>
            <div *ngIf="selectedObject.objectType === 'Location'">
                <div *ngFor="let location of selectedObject.locations">
                    <a href="javascript:void(0)">{{ getLocationName(location.location) }}</a>
                </div>
                <div *ngIf="selectedObject.identifiers.length > 0">
                    <span>More information...</span>
                    <div *ngFor="let identifier of selectedObject.identifiers">
                        <a [href]="identifier.url" target="_blank">{{ identifier.identifierType }}</a>
                    </div>
                </div>
            </div>
        </div>
    </mat-sidenav>

    <mat-sidenav-content>
        <div id="options">
            <div class="no-margin">
                <button mat-flat-button (click)="getList()"><mat-icon>list</mat-icon> show list</button>
                <button mat-flat-button (click)="clearList()"><mat-icon>clear_all</mat-icon> hide list</button>
            </div>
            <div class="no-margin">
                <button mat-flat-button (click)="clearTimeSelection()"><mat-icon>refresh</mat-icon> clear selection</button> <br>
                <button mat-flat-button (click)="toggleMouseBehavior()"><mat-icon>{{ mouseBehavior ? 'radio_button_checked' : 'radio_button_unchecked'}}</mat-icon> toggle mouse behavior</button> <br>
                <button mat-flat-button (click)="toggleBrushBehavior()"><mat-icon>{{ brushBehavior ? 'radio_button_checked' : 'radio_button_unchecked'}}</mat-icon> toggle brush visibility</button> <br>
                <button *ngIf="dataType == 'people'" mat-flat-button (click)="showExile()"><mat-icon>{{ showExiled ? 'radio_button_checked' : 'radio_button_unchecked'}}</mat-icon> show exile</button> <br *ngIf="dataType === 'people'">
                <button mat-flat-button (click)="toggleNames()"><mat-icon>{{ showNames ? 'radio_button_checked' : 'radio_button_unchecked'}}</mat-icon> show names</button>
                <!-- <button mat-flat-button (click)="updateScales()"><mat-icon>zoom_in</mat-icon> apply zoom</button> -->
            </div>
            <!-- <div>
                <mat-slide-toggle (change)="toggleBrush()">Brush</mat-slide-toggle>
            </div> -->
            <mat-form-field>
                <mat-label>Event Type Filter</mat-label>
                <mat-select placeholder="Event Type Filter by" (selectionChange)="filterEventsByType($event.value)">
                    <mat-option *ngFor="let e of eventTypes" [value]="e">{{ e }}</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field>
                <mat-label>Order by</mat-label>
                <mat-select [(value)]="currentOrder" placeholder="Order by" (selectionChange)="updateOrder()">
                    <mat-option *ngFor="let o of ordering" [value]="o">{{ o }}</mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field>
                    <mat-label>Group by</mat-label>
                    <mat-select [(value)]="currentGrouping" placeholder="Group by" (selectionChange)="updateGroup()">
                        <mat-option *ngFor="let o of grouping" [value]="o">{{ o }}</mat-option>
                    </mat-select>
                </mat-form-field>
            <div id="autocomplete">
                <mat-form-field>
                    <input matInput placeholder="Person/Location" [matAutocomplete]="auto" [formControl]="objectCtrl">
                    <button mat-button matSuffix mat-icon-button aria-label="Clear" (click)="clearAutoComplete()">
                        <mat-icon>close</mat-icon>
                    </button>
                    <mat-autocomplete #auto="matAutocomplete">
                        <mat-option *ngFor="let person of filteredObjects | async" [value]="person.name" (click)="displayPersonDetails(person.name)">
                            <span>{{ person.name }}</span> 
                        </mat-option>
                    </mat-autocomplete>
                </mat-form-field>
                <mat-form-field>
                    <button mat-button matPrefix mat-icon-button (click)="saveConfig()">
                        <mat-icon>code</mat-icon>
                    </button>
                    <input matInput type="text" id="config-url" placeholder="Config URL" #configInput>
                </mat-form-field>
            </div>
        </div>
        <div id="wrapper">
            <div id="timeline-radial" #timelineRadial></div>
            <div id="timeline-chart" #timelineChart></div>
            <div id="people">
                <mat-accordion>
                    <mat-expansion-panel *ngFor="let p of currentlySelectedPeople">
                        <mat-expansion-panel-header class="people-headers-align">
                            <mat-panel-title><b>{{ p.name }}</b></mat-panel-title>
                            <mat-panel-description>{{ p.events.length }} events</mat-panel-description>
                        </mat-expansion-panel-header>
                        <button mat-flat-button (click)="displayPersonDetails(p.name)"><mat-icon>info</mat-icon> Details</button>
                        <div *ngFor="let e of p.events">    
                            <div class="event-dot" [ngStyle]="{'background-color': getColorForType(e.color)}" [matTooltip]="e.color"></div>
                            <h4 class="event-header">{{ e.dateName }}</h4>
                            <p>({{ displayDate(e.startDate) }} - {{ displayDate(e.endDate) }})</p>
                        </div>
                    </mat-expansion-panel>
                </mat-accordion>
            </div>
        </div>
        <div id="date-extent">
            <h3>{{ displayDate(currentlySelectedMinDate) }}</h3>
            <h3>&nbsp; - &nbsp;</h3>
            <h3>{{ displayDate(currentlySelectedMaxDate) }}
                ({{ getDuration(currentlySelectedMinDate, currentlySelectedMaxDate)}} years)</h3>
        </div>
        <div class="chrono-filter">
            <mat-form-field>
                <input matInput placeholder="Filter by historic period" [matAutocomplete]="autoChrono" [formControl]="histFilterCtrl">
                <button mat-button matSuffix mat-icon-button aria-label="Clear" (click)="clearChronoAutoComplete()">
                    <mat-icon>close</mat-icon>
                </button>
                <mat-autocomplete #autoChrono="matAutocomplete">
                    <mat-option *ngFor="let histEv of filteredHistEvents | async" [value]="histEv.name" (click)="chronoFilter(histEv)">
                        <span>{{ histEv.name }}</span> |
                        <small>{{ displayDate(histEv.startDate) }} -  {{ displayDate(histEv.endDate) }}</small>
                    </mat-option>
                </mat-autocomplete>
            </mat-form-field>
        </div>

    </mat-sidenav-content>
</mat-sidenav-container>

<div id="tooltip" #tooltip></div>
<div id="count-tooltip"></div>